Erreur d’appel API: 401
Aucune donnée météo récupérée.
 Envoi vers Kafka : {'temperature': 29, 'humidity': 79, 'windSpeed': 4.1, 'cloudCover': 18, 'rainIntensity': 0, 'timestamp': '2025-08-04T11:57:00Z'}
Traceback (most recent call last):
  File "/home/el-malick-devdata/Bureau/Data_meteo/collecte/api/kafka/producer.py", line 47, in <module>
    run()
  File "/home/el-malick-devdata/Bureau/Data_meteo/collecte/api/kafka/producer.py", line 41, in run
    producer.send(TOPIC_NAME, weather_data)
  File "/home/el-malick-devdata/Bureau/Data_meteo/env/lib/python3.11/site-packages/kafka/producer/kafka.py", line 840, in send
    self._wait_on_metadata(topic, timer.timeout_ms)
  File "/home/el-malick-devdata/Bureau/Data_meteo/env/lib/python3.11/site-packages/kafka/producer/kafka.py", line 964, in _wait_on_metadata
    raise Errors.KafkaTimeoutError(
kafka.errors.KafkaTimeoutError: KafkaTimeoutError: Failed to update metadata after 60.0 secs.
 Envoi vers Kafka : {'temperature': 29, 'humidity': 79, 'windSpeed': 4.1, 'cloudCover': 18, 'rainIntensity': 0, 'timestamp': '2025-08-04T12:00:00Z'}
Traceback (most recent call last):
  File "/home/el-malick-devdata/Bureau/Data_meteo/collecte/api/kafka/producer.py", line 47, in <module>
    run()
  File "/home/el-malick-devdata/Bureau/Data_meteo/collecte/api/kafka/producer.py", line 41, in run
    producer.send(TOPIC_NAME, weather_data)
  File "/home/el-malick-devdata/Bureau/Data_meteo/env/lib/python3.11/site-packages/kafka/producer/kafka.py", line 840, in send
    self._wait_on_metadata(topic, timer.timeout_ms)
  File "/home/el-malick-devdata/Bureau/Data_meteo/env/lib/python3.11/site-packages/kafka/producer/kafka.py", line 964, in _wait_on_metadata
    raise Errors.KafkaTimeoutError(
kafka.errors.KafkaTimeoutError: KafkaTimeoutError: Failed to update metadata after 60.0 secs.
 Envoi vers Kafka : {'temperature': 29, 'humidity': 79, 'windSpeed': 4.1, 'cloudCover': 18, 'rainIntensity': 0, 'timestamp': '2025-08-04T12:03:00Z'}
 Envoi vers Kafka : {'temperature': 28.4, 'humidity': 69, 'windSpeed': 4.4, 'cloudCover': 43, 'rainIntensity': 0, 'timestamp': '2025-08-04T12:06:00Z'}
 Envoi vers Kafka : {'temperature': 28.4, 'humidity': 69, 'windSpeed': 4.4, 'cloudCover': 43, 'rainIntensity': 0, 'timestamp': '2025-08-04T12:09:00Z'}


